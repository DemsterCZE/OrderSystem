<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Kavárna U Pole | Detail objednávky č. {{order.order_id}}</title>
    {% load static %}
    {% load qr_code %}
    <link rel="stylesheet" href="{% static 'order_detail.css' %}">
</head>
<body>
<div class="detail-container">
    <h2>Objednávka č. {{ order.order_id }}</h2>
    <p><strong>Stůl:</strong> {{ order.table_id.table_name }}</p>
    <p><strong>Čas vytvoření:</strong> {{ order.order_time|date:"H:i:s" }}</p>
    {% if order.assigned_employee %}
    <p><strong>Čas přijetí:</strong> {{ order.accepted_time|date:"H:i:s" }}</p>
    {% endif %}
    <p><strong>Objednávku má na starosti:</strong> {{order.assigned_employee|default:"nikdo"}} </p>

    <table class="items-table">
        <thead>
        <tr>
            <th>Položka</th>
            <th>Množství</th>
            <th>Cena/ks</th>
            <th>Celkem</th>
        </tr>
        </thead>
        <tbody>
        {% for item in order.items.all %}
        <tr>
            <td>{{ item.item.item_name }}</td>
            <td>{{ item.quantity }}x</td>
            <td>{{ item.item.price }} Kč</td>
            <td>{{ item.total_item_price }} Kč</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">Tato objednávka nemá žádné položky.</td>
        </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>
            <th colspan="3">Celková cena objednávky:</th>
            <th>{{ order.get_total_order_price }} Kč</th>
        </tr>
        </tfoot>
    </table>

    <div style="margin-top: 20px;">
        <button class="btn-back" onclick="window.close()">Zpět na přehled</button>
    </div>
    <h2 style="margin-top: 20px">QR Kód stolu</h2>
    {% url 'table' order.table_id.id as table_url %}
    {% with full_url=request.scheme|add:"://"|add:request.get_host|add:table_url %}
    <img src="{% qr_url_from_text full_url %}" alt="QR kód stolu">
    {% endwith %}
</div>

</body>
</html>